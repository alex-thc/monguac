This is a fork of MongoDB 4.0.12 to allow running mongoS on top of a single replica set *without* sharding - the replica set doesn't know anything about sharding and no config servers. It can be useful for applications that only support connections to standalone, or as a connection-pooling proxy.

Although the code passes some tests, it's only a *prototype*. *Use it at your own risk*, preferably not in critical production systems. It is not officially supported, and actually not supported it all.

Changes from the mainstream:
* mongoD: assumes a dummy shard name when contacted by mongoS (for currentOp)
* mongoS: support for "hostdb" and "hostInternalUser" parameters

How to build:
python2 buildscripts/scons.py --disable-warnings-as-errors --ssl mongos
python2 buildscripts/scons.py --disable-warnings-as-errors --ssl mongod

How to run:
_Make sure you use the binaries you've built and not the ones in your $PATH_
* No authentication
1) Start and configure a replica set as you normally would
2) ./mongos --hostdb <RS_NAME>/<HOST1>:<PORT1>,<HOST2>:<PORT2>
3) connect to mongoS and enjoy

* Authentication
1) Start and configure a replica set with authentication as you normally would
2) Add an internal mongoS user on the replica set
use admin
db.createUser(
   {
     user: "mongos",
     pwd: "<cleartext password>" //don't use special symbols in it
     roles: [ “__system”]
   }
)
3) Create a key file with the mongos password in it
echo "<cleartext password>" > mongos_key
4) ./mongos --hostdb <RS_NAME>/<HOST1>:<PORT1>,<HOST2>:<PORT2> --keyFile mongos_key --hostInternalUser mongos
5) connect to mongoS and enjoy

* SSL
Assuming there's a replica set with authentication and SSL configured (but client certificate is not required):
1) Add an internal mongoS user as in the example above
2) Generate a certificate for mongoS, e.g.
openssl req -new -newkey rsa:2048 -days 365 -nodes -x509 -keyout server.key -out server.crt
cat server.key server.crt > mongos.pem
2) ./mongos --hostdb <RS_NAME>/<HOST1>:<PORT1>,<HOST2>:<PORT2> --keyFile mongos_key --hostInternalUser mongos --sslMode requireSSL --setParameter sslWithholdClientCertificate=true --sslPEMKeyFile mongos.pem 
3) connect to mongoS with SSL and enjoy

What doesn't work:
* Running on top of Atlas replica set due to a limited permissions model

-----------------
MongoDB README

Welcome to MongoDB 4.0!

COMPONENTS

  mongod - The database server.
  mongos - Sharding router.
  mongo  - The database shell (uses interactive javascript).

UTILITIES

  mongodump         - Create a binary dump of the contents of a database.
  mongorestore      - Restore data from the output created by mongodump.
  mongoexport       - Export the contents of a collection to JSON or CSV.
  mongoimport       - Import data from JSON, CSV or TSV.
  mongofiles        - Put, get and delete files from GridFS.
  mongostat         - Show the status of a running mongod/mongos.
  bsondump          - Convert BSON files into human-readable formats.
  mongoreplay       - Traffic capture and replay tool.
  mongotop          - Track time spent reading and writing data.
  install_compass   - Installs MongoDB Compass for your platform.

BUILDING

  See docs/building.md.

RUNNING

  For command line options invoke:

    $ ./mongod --help

  To run a single server database:

    $ sudo mkdir -p /data/db
    $ ./mongod
    $
    $ # The mongo javascript shell connects to localhost and test database by default:
    $ ./mongo
    > help

INSTALLING COMPASS

  You can install compass using the install_compass script packaged with MongoDB:

    $ ./install_compass

  This will download the appropriate MongoDB Compass package for your platform
  and install it.

DRIVERS

  Client drivers for most programming languages are available at
  https://docs.mongodb.com/manual/applications/drivers/. Use the shell
  ("mongo") for administrative tasks.

BUG REPORTS

  See https://github.com/mongodb/mongo/wiki/Submit-Bug-Reports.

PACKAGING

  Packages are created dynamically by the package.py script located in the
  buildscripts directory. This will generate RPM and Debian packages.

DOCUMENTATION

  https://docs.mongodb.com/manual/

CLOUD HOSTED MONGODB

  https://www.mongodb.com/cloud/atlas

MAIL LISTS

  https://groups.google.com/forum/#!forum/mongodb-user

    A forum for technical questions about using MongoDB.

  https://groups.google.com/forum/#!forum/mongodb-dev

    A forum for technical questions about building and developing MongoDB.

LEARN MONGODB

  https://university.mongodb.com/

LICENSE

  MongoDB is free and the source is available. Versions released prior to
  October 16, 2018 are published under the AGPL. All versions released after
  October 16, 2018, including patch fixes for prior versions, are published
  under the Server Side Public License (SSPL) v1. See individual files for
  details.
